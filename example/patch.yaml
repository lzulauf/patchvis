definitions:
  NiftyCaseInput:
      type: midiToCV
      outputs:
        - cv_1
        - gate_1
        - cv_2
        - gate_2
        - mod
        - clock

  AttenOff:
      type: O_C Applet
      inputs:
        - trig_1
        - trig_2
        - cv_1
        - cv_2
      outputs:
        - out_a
        - out_b
      knobs:
        - name: off_a
          value: 0
          position: {x: 35, y: 140}
        - name: scale_a
          value: 1.0
          position: {x: 85, y: 140}
        - name: off_b
          value: 0
          position: {x: 35, y: 205}
        - name: scale_b
          value: 1.0
          position: {x: 85, y: 205}

  Chips:
      type: vco
      width: 120
      height: 270
      inputs:
        - chip1_tune
        - chip1_filter
        - chip2_tune
        - chip2_width
        - lfo_reset
      outputs:
        - chip1
        - chip2
        - lfo1
        - lfo2
      knobs:
        - name: tune_1
          value: 0
          radius: 8
          position: {x: 20, y: 150}
        - name: filter_1
          value: 0
          radius: 8
          position: {x: 60, y: 150}
        - name: wave_1
          value: 0
          radius: 8
          position: {x: 100, y: 150}
        - name: tune_2
          value: 0
          radius: 8
          position: {x: 20, y: 195}
        - name: width_2
          value: 0
          radius: 8
          position: {x: 60, y: 195}
        - name: wave_2
          value: 0
          radius: 8
          position: {x: 100, y: 195}
        - name: rate_lfo
          value: 0
          radius: 8
          position: {x: 20, y: 240}
        - name: depth_lfo
          value: 0
          radius: 8
          position: {x: 60, y: 240}
        - name: wave_lfo
          value: 0
          radius: 8
          position: {x: 100, y: 240}
    
  StagesDAHDSR:
      type: envelope
      inputs: ["level", "gate"]
      outputs: ["out"]
      knobs:
        - name: delay
          value: 0
          radius: 8
          position: {x: 40, y: 155}
        - name: hold
          value: 0
          radius: 8
          position: {x: 80, y: 155}
        - name: att
          radius: 10
          position: {x: 20, y: 210}
        - name: dec
          radius: 10
          position: {x: 46, y: 210}
        - name: sus
          radius: 10
          position: {x: 74, y: 210}
        - name: rel
          radius: 10
          position: {x: 100, y: 210}
        - name: att_
          radius: 8
          position: {x: 20, y: 100}
        - name: dec_
          radius: 8
          position: {x: 60, y: 100}
        - name: rel_
          radius: 8
          position: {x: 100, y: 100}
    
  Plaits:
      width: 220
      inputs:
        - v/oct
        - trig
        - level
        - model
        - timbre 
        - fm 
        - morph
        - harmon
      outputs:
        - out
        - aux
      knobs:
        - name: type
          radius: 5
          position: {x: 70, y: 70}
          positions:
            - Green
            - Red
            - Orange
        - name: model
          radius: 5
          position: {x: 110, y: 70}
          positions: [1, 2, 3, 4, 5, 6, 7, 8]
        - name: harmonics
          position: {x: 150, y: 70}
        - name: timbre
          position: {x: 70, y: 130}
        - name: morph
          position: {x: 150, y: 130}
        - name: fm_
          radius: 8
          position: {x: 110, y: 190}
        - name: timbre_
          radius: 8
          position: {x: 70, y: 190}
        - name: morph_
          radius: 8
          position: {x: 150, y: 190}
    
  Veils:
      type: amplifier
      width: 120
      height: 250
      inputs:
        - cv
        - in
      outputs:
        - out
      knobs:
        - name: shape
          value: 0
          radius: 10
          position: {x: 60, y: 60}
        - name: offset
          value: 0
          radius: 10
          position: {x: 60, y: 110}
        - name: level
          value: 1.0
          radius: 20
          position: {x: 60, y: 180}
    
  NiftyCaseOutput:
      type: midiToCV
      inputs:
        - out_1
        - out_2
  Strum:
        type: O_C Applet
        inputs:
          - trig_1
          - trig_2
          - cv_1
          - cv_2
        outputs:
          - out_a
          - out_b
        knobs:
          - name: scale
            positions: [1, 2, 3, 4, 5, 6, 7, 8]
            value: 0
            position: {x: 35, y: 140}
          - name: root
            positions: ['c', 'd', 'e', 'f', 'g', 'a', 'b']
            value: 0
            position: {x: 85, y: 140}
          - name: time
            value: 0.5
            position: {x: 35, y: 205}
          - name: length
            positions: [1, 2, 3, 4, 5, 6]
            value: 2
            position: {x: 85, y: 205}
    
modules:
  - name: CaseIn
    definition: NiftyCaseInput
    position: {x: 0, y: 100}

  - name: AttenOff
    definition: AttenOff
    position: {x: 175, y: 0}

  - name: Strum
    definition: Strum
    position: {x: 350, y: 0}

  - name: Chips
    definition: Chips
    position: {x: 350, y: 300}
    knobs:
      rate_lfo: 0.9
      depth_lfo: 0.55
      wave_lfo: 0

  - name: Envelope1
    definition: StagesDAHDSR
    position: {x: 550, y: 0}
    knobs:
      att: 0.1
      dec: 0.85
      sus: 1.0
      rel: 0.45

  - name: Plaits
    definition: Plaits
    position: {x: 525, y: 300}
    knobs:
      type: 0
      model: 6
      harmonics: 0.15
      timbre: 0.3
      morph: 0.45
      timbre_: 0.55
      fm_: 0.68
      morph_: 0.55
      
  - name: Veils1
    definition: Veils
    position: {x: 800, y: 100}

  - name: CaseOut
    definition: NiftyCaseOutput
    position: {x: 980, y: 100}

connections:
  - from: CaseIn:cv_1
    to: AttenOff:cv_1
    color: orange
  - from: CaseIn:gate_1
    to: Strum:trig_1
    color: blue
  - from: AttenOff:out_a
    to: Strum:cv_1
    color: orange
  - from: Chips:lfo1
    to: Plaits:timbre
    color: green
  - from: Chips:lfo2
    to: Plaits:morph
    color: green
  - from: Strum:out_a
    to: Plaits:v/oct
    color: orange
  - from: Strum:out_b
    to: Envelope1:gate
    color: blue
  - from: Plaits:out
    to: Veils1:in
    color: red
  - from: Envelope1:out
    to: Veils1:cv
    color: green
  - from: Veils1:out
    to: CaseOut:out_1
    color: red